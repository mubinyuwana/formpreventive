<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preventive Maintenance - Control Valve Check</title>
    <style>
        /* CSS styling */
        body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }

      label {
        display: block;
        margin-bottom: 5px;
      }

      input {
        width: calc(50% - 5px);
        padding: 8px;
        margin-bottom: 10px;
        border-radius: 6px;
      }

      select {
        width: calc(70% - 3px);
        padding: 8px;
        margin-bottom: 10px;
        border-radius: 6px;
      }

      textarea {
  width: calc(55% - 5px);
  height: 150px;
  padding: 8px;
  box-sizing: border-box;
  border: 2px solid #ccc;
  border-radius: 6px;
  background-color: #f8f8f8;
  font-size: 12px;
  resize: none;
}

      button1 {
        padding: 10px;
        background-color: #3dd816;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 8px;
      }
      button2 {
        padding: 10px;
        background-color: #2093f1;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 8px;
      }
      .flex-container {
  display: flex;
  flex: 50%
  align-items: center;
  flex-wrap: wrap;
  align-content: flex-start;
  border-radius: 6px;
  background-color: DodgerBlue;
}
      .flex-container > div {
  background-color: #f1f1f1;
  width: 200px;
  margin: 5px;
  text-align: center;
  line-height: 15px;
  font-size: 15px;
  border-radius: 6px;
}


/* Responsive layout - makes a one column-layout instead of two-column layout */
@media (max-width: 800px) {
  .flex-container {
    flex-direction: column;
  }
}

    </style>
</head>
<body>
    <div class="container">
        <h2>Preventive Maintenance - Control Valve Check</h2>
        <div id="equipmentForms">
            <!-- Initial form for the first equipment -->
            <form class="equipmentForm">
                
                <label for="valveNumber">Valve Number:</label>
                <input type="text" class="valveNumber" name="valveNumber" required /> <br><br>
                
                <label for="checkDate">Check Date:</label>
                <input type="date" class="checkDate" name="checkDate" required /> <br><br>

                <label for="checkBy">Checked By:</label>
                <input type="text" class="checkBy" name="checkBy" required /> <br><br>

                <label for="valvePosition">Valve Position:</label>
                <input type="text" class="valvePosition" name="valvePosition" required /> <br><br>
                
                <div class="flex-container">
                <div>
                <label for="positionerCondition">Positioner Condition:</label>
                <select class="positionerCondition" name="positionerCondition" required >
                    <option value="none">None</option>
                    <option value="corrosion">Corrosion</option>
                    <option value="crack">Crack</option>
                    <option value="leakage_out">Leakage Out</option>
                    <option value="leakage_throw">Leakage Throw</option>
                </select> 
                </div>
                <div>
                <label for="actuatorCondition">Actuator Condition:</label>
                <select class="actuatorCondition" name="actuatorCondition" required >
                    <option value="none">None</option>
                    <option value="corrosion">Corrosion</option>
                    <option value="crack">Crack</option>
                    <option value="leakage_out">Leakage Out</option>
                    <option value="leakage_throw">Leakage Throw</option>
                </select>
                </div>
                <div>
                  <label for="yokeCondition">Yoke Condition:</label>
                  <select class="yokeCondition" name="yokeCondition" required >
                      <option value="none">None</option>
                      <option value="corrosion">Corrosion</option>
                      <option value="crack">Crack</option>
                      <option value="leakage_out">Leakage Out</option>
                      <option value="leakage_throw">Leakage Throw</option>
                  </select>
                  </div>
                  <div>
                    <label for="stemCondition">Stem Condition:</label>
                    <select class="stemCondition" name="stemCondition" required >
                        <option value="none">None</option>
                        <option value="corrosion">Corrosion</option>
                        <option value="crack">Crack</option>
                        <option value="leakage_out">Leakage Out</option>
                        <option value="leakage_throw">Leakage Throw</option>
                    </select>
                    </div>
                    <div>
                      <label for="regulatorCondition">Regulator Condition:</label>
                      <select class="regulatorCondition" name="regulatorCondition" required >
                          <option value="none">None</option>
                          <option value="corrosion">Corrosion</option>
                          <option value="crack">Crack</option>
                          <option value="leakage_out">Leakage Out</option>
                          <option value="leakage_throw">Leakage Throw</option>
                      </select>
                      </div>
                      <div>
                        <label for="tubbingCondition">Tubbing Condition:</label>
                        <select class="tubbingCondition" name="tubbingCondition" required >
                            <option value="none">None</option>
                            <option value="corrosion">Corrosion</option>
                            <option value="crack">Crack</option>
                            <option value="leakage_out">Leakage Out</option>
                            <option value="leakage_throw">Leakage Throw</option>
                        </select>
                        </div>
                        <div>
                          <label for="couplingCondition">Coupling Condition:</label>
                          <select class="couplingCondition" name="couplingCondition" required >
                              <option value="none">None</option>
                              <option value="corrosion">Corrosion</option>
                              <option value="crack">Crack</option>
                              <option value="leakage_out">Leakage Out</option>
                              <option value="leakage_throw">Leakage Throw</option>
                          </select>
                          </div>
                          <div>
                            <label for="bodyCondition">Body Valve Condition:</label>
                            <select class="bodyCondition" name="bodyCondition" required >
                                <option value="none">None</option>
                                <option value="corrosion">Corrosion</option>
                                <option value="crack">Crack</option>
                                <option value="leakage_out">Leakage Out</option>
                                <option value="leakage_throw">Leakage Throw</option>
                            </select>
                            </div>
                            <div>
                              <label for="bonetflangeCondition">Bonet Flange Condition:</label>
                              <select class="bonetflangeCondition" name="bonetflangeCondition" required >
                                  <option value="none">None</option>
                                  <option value="corrosion">Corrosion</option>
                                  <option value="crack">Crack</option>
                                  <option value="leakage_out">Leakage Out</option>
                                  <option value="leakage_throw">Leakage Throw</option>
                              </select>
                              </div>
                              <div>
                                <label for="bodyflangeCondition">Body Valve Flange Condition:</label>
                                <select class="bodyflangeCondition" name="bodyflangeCondition" required >
                                    <option value="none">None</option>
                                    <option value="corrosion">Corrosion</option>
                                    <option value="crack">Crack</option>
                                    <option value="leakage_out">Leakage Out</option>
                                    <option value="leakage_throw">Leakage Throw</option>
                                </select>
                                </div>
              </div>
              <br><br>
                <label for="valveCondition">Valve Condition:</label> 
                <textarea class="valveCondition" name="valveCondition" rows="4" required></textarea> <br><br>
                <br><br>
            </form>
        </div>
        <button1 type="button1" onclick="addEquipmentForm()">Add Equipment</button1> <br><br>
        <input type="text" id="fileName" placeholder="Enter file name..."> <br><br>
        <button2 type="button2" onclick="generateCSV()">Download CSV File</button2>
    </div>

    <script>
        function addEquipmentForm() {
            var equipmentForms = document.getElementById('equipmentForms');
            var newForm = document.createElement('form');
            newForm.classList.add('equipmentForm');
            newForm.innerHTML = `
            <label for="valveNumber">Valve Number:</label>
                <input type="text" class="valveNumber" name="valveNumber" required /> <br><br>
                
                <label for="checkDate">Check Date:</label>
                <input type="date" class="checkDate" name="checkDate" required /> <br><br>

                <label for="checkBy">Checked By:</label>
                <input type="text" class="checkBy" name="checkBy" required /> <br><br>

                <label for="valvePosition">Valve Position:</label>
                <input type="text" class="valvePosition" name="valvePosition" required /> <br><br>
                
                <div class="flex-container">
                <div>
                <label for="positionerCondition">Positioner Condition:</label>
                <select class="positionerCondition" name="positionerCondition" required >
                    <option value="none">None</option>
                    <option value="corrosion">Corrosion</option>
                    <option value="crack">Crack</option>
                    <option value="leakage_out">Leakage Out</option>
                    <option value="leakage_throw">Leakage Throw</option>
                </select> 
                </div>
                <div>
                <label for="actuatorCondition">Actuator Condition:</label>
                <select class="actuatorCondition" name="actuatorCondition" required >
                    <option value="none">None</option>
                    <option value="corrosion">Corrosion</option>
                    <option value="crack">Crack</option>
                    <option value="leakage_out">Leakage Out</option>
                    <option value="leakage_throw">Leakage Throw</option>
                </select>
                </div>
                <div>
                  <label for="yokeCondition">Yoke Condition:</label>
                  <select class="yokeCondition" name="yokeCondition" required >
                      <option value="none">None</option>
                      <option value="corrosion">Corrosion</option>
                      <option value="crack">Crack</option>
                      <option value="leakage_out">Leakage Out</option>
                      <option value="leakage_throw">Leakage Throw</option>
                  </select>
                  </div>
                  <div>
                    <label for="stemCondition">Stem Condition:</label>
                    <select class="stemCondition" name="stemCondition" required >
                        <option value="none">None</option>
                        <option value="corrosion">Corrosion</option>
                        <option value="crack">Crack</option>
                        <option value="leakage_out">Leakage Out</option>
                        <option value="leakage_throw">Leakage Throw</option>
                    </select>
                    </div>
                    <div>
                      <label for="regulatorCondition">Regulator Condition:</label>
                      <select class="regulatorCondition" name="regulatorCondition" required >
                          <option value="none">None</option>
                          <option value="corrosion">Corrosion</option>
                          <option value="crack">Crack</option>
                          <option value="leakage_out">Leakage Out</option>
                          <option value="leakage_throw">Leakage Throw</option>
                      </select>
                      </div>
                      <div>
                        <label for="tubbingCondition">Tubbing Condition:</label>
                        <select class="tubbingCondition" name="tubbingCondition" required >
                            <option value="none">None</option>
                            <option value="corrosion">Corrosion</option>
                            <option value="crack">Crack</option>
                            <option value="leakage_out">Leakage Out</option>
                            <option value="leakage_throw">Leakage Throw</option>
                        </select>
                        </div>
                        <div>
                          <label for="couplingCondition">Coupling Condition:</label>
                          <select class="couplingCondition" name="couplingCondition" required >
                              <option value="none">None</option>
                              <option value="corrosion">Corrosion</option>
                              <option value="crack">Crack</option>
                              <option value="leakage_out">Leakage Out</option>
                              <option value="leakage_throw">Leakage Throw</option>
                          </select>
                          </div>
                          <div>
                            <label for="bodyCondition">Body Valve Condition:</label>
                            <select class="bodyCondition" name="bodyCondition" required >
                                <option value="none">None</option>
                                <option value="corrosion">Corrosion</option>
                                <option value="crack">Crack</option>
                                <option value="leakage_out">Leakage Out</option>
                                <option value="leakage_throw">Leakage Throw</option>
                            </select>
                            </div>
                            <div>
                              <label for="bonetflangeCondition">Bonet Flange Condition:</label>
                              <select class="bonetflangeCondition" name="bonetflangeCondition" required >
                                  <option value="none">None</option>
                                  <option value="corrosion">Corrosion</option>
                                  <option value="crack">Crack</option>
                                  <option value="leakage_out">Leakage Out</option>
                                  <option value="leakage_throw">Leakage Throw</option>
                              </select>
                              </div>
                              <div>
                                <label for="bodyflangeCondition">Body Valve Flange Condition:</label>
                                <select class="bodyflangeCondition" name="bodyflangeCondition" required >
                                    <option value="none">None</option>
                                    <option value="corrosion">Corrosion</option>
                                    <option value="crack">Crack</option>
                                    <option value="leakage_out">Leakage Out</option>
                                    <option value="leakage_throw">Leakage Throw</option>
                                </select>
                                </div>
              </div>
              <br><br>
                <label for="valveCondition">Valve Condition:</label> 
                <textarea class="valveCondition" name="valveCondition" rows="4" required></textarea> <br><br>
                <br><br>
            `;
            equipmentForms.appendChild(newForm);
        }

        function generateCSV() {
            var equipmentForms = document.querySelectorAll('.equipmentForm');
            var csvContent = "Valve Number,Check Date,Checked By,Valve Position,Positioner Condition,Valve Condition\n";
            var fileName = document.getElementById('fileName').value || 'pm_check'; // Default file name

            equipmentForms.forEach(function(form) {
                var valveNumber = form.querySelector('.valveNumber').value;
                var checkDate = form.querySelector('.checkDate').value;
                var checkBy = form.querySelector('.checkBy').value;
                var valvePosition = form.querySelector('.valvePosition').value;
                var positionerCondition = form.querySelector('.positionerCondition').value;
                var valveCondition = form.querySelector('.valveCondition').value;

                csvContent += `${valveNumber},${checkDate},${checkBy},${valvePosition},${positionerCondition},"${valveCondition}"\n`;
            });

            var blob = new Blob([csvContent], { type: 'text/csv' });
            var link = document.createElement('a');
            link.download = fileName + '.csv';
            link.href = window.URL.createObjectURL(blob);
            link.click();
        }
    </script>
</body>
</html>
